# 回測伺服器專案第三方依賴庫規範

本文檔定義了回測伺服器專案使用的第三方庫與框架。所有開發者應遵循此規範，以保持代碼一致性並避免衝突。

## 1. 核心非同步運行時

| 套件名稱 | 版本 | 用途 | 備註 |
|---------|------|------|------|
| **tokio** | ^1.45.0 | 非同步運行時 | 專案的核心非同步框架，所有I/O操作均使用tokio |
| futures | ^0.3.31 | Future工具 | 提供 Stream、Sink 等抽象和各種工具函數 |
| async-trait | ^0.1.88 | 非同步特徵 | 實現異步trait方法 |


## 2. Web框架與API

| 套件名稱 | 版本 | 用途 | 備註 |
|---------|------|------|------|
| **axum** | ^0.8.4 | Web框架 | 處理HTTP請求和路由 |
| tower | ^0.5.2 | HTTP服務抽象 | 提供中間件系統 |
| tower-http | ^0.6.4 | HTTP特定中間件 | 提供CORS、壓縮、認證等中間件 |


## 3. 資料庫與存儲

| 套件名稱 | 版本 | 用途 | 備註 |
|---------|------|------|------|
| **sqlx** | ^0.8.5 | 數據庫驅動與ORM | 支持編譯時SQL檢查 |
| **redis** | ^0.31.0 | 高速數據快取 | 事件處理系統 |
| **bb8-redis** | ^0.23.0 | redis 連接池 |  |


## 4. 序列化與資料格式

| 套件名稱 | 版本 | 用途 | 備註 |
|---------|------|------|------|
| **serde** | ^1.0.219 | 序列化框架 | 所有資料結構通用的序列化/反序列化 |
| serde_json | ^1.0.140 | JSON支持 | API響應、配置等 |
| **serde_yaml_bw** | ^1.0.4 | YAML支持 | 策略DSL解析 |
| csv | ^1.3.1 | CSV處理 | 數據導入、導出 |
| toml | ^0.8.22 | TOML處理 | 配置文件解析 |
| hex | ^0.4.3 | 十六進制編碼 | 數據編碼/解碼 |


## 5. 日誌與監控

| 套件名稱 | 版本 | 用途 | 備註 |
|---------|------|------|------|
| **tracing** | ^0.1.41 | 結構化日誌 | 取代 log 標準庫 |
| tracing-subscriber | ^0.3.19 | 日誌訂閱者 | 配置和格式化 |
| tracing-appender | ^0.2.3 | 日誌文件輸出 | 寫入文件系統 |
| metrics | ^0.24.2 | 指標收集 | 性能監控 |
| metrics-exporter-prometheus | ^0.17.0 | Prometheus導出 | 用於監控系統集成 |


## 6. 時間與日期處理

| 套件名稱 | 版本 | 用途 | 備註 |
|---------|------|------|------|
| **chrono** | ^0.4.41 | 時間和日期 | 時間序列和交易相關操作 |


## 7. 數值計算與統計

| 套件名稱 | 版本 | 用途 | 備註 |
|---------|------|------|------|
| **ndarray** | ^0.16.1 | 多維數組 | 高效數值計算 |
| statrs | ^0.18.0 | 統計運算 | 性能指標計算 |
| rust_decimal | ^1.37.1 | 高精度十進制 | 財務計算 |
| rust_decimal_macros | ^1.37.1 | Decimal字面量 | 用於直接定義Decimal常量 |
| polars | ^0.47.1 | 數據框架 | 類似pandas的高效數據處理 |
| rand | ^0.9.1 | 隨機數生成 | 模擬和測試用途 |


## 8. 錯誤處理

| 套件名稱 | 版本 | 用途 | 備註 |
|---------|------|------|------|
| **thiserror** | ^2.0.12 | 自定義錯誤類型 | 定義應用特定錯誤 |
| anyhow | ^1.0.98 | 通用錯誤處理 | 用於返回不確定錯誤類型的場景 |


## 9. 參數解析與配置

| 套件名稱 | 版本 | 用途 | 備註 |
|---------|------|------|------|
| **config** | ^0.15.11 | 配置管理 | 多格式、分層配置 |
| clap | ^4.5.38 | 命令行參數 | 用於CLI工具 |
| semver | ^1.0.26 | 語義化版本 | 版本控制和比較 |


## 10. 工具與性能優化

| 套件名稱 | 版本 | 用途 | 備註 |
|---------|------|------|------|
| **parking_lot** | ^0.12.3 | 同步原語 | 比標準庫更高效的鎖 |
| once_cell | ^1.21.3 | 單次初始化 | 現代版的靜態變量惰性初始化 |
| uuid | ^1.16.0 | UUID生成 | 用於唯一ID |
| rayon | ^1.10.0 | CPU並行計算 | 數據處理加速 |
| dashmap | ^6.1.0 | 並行哈希表 | 高並發快取 |
| crossbeam | ^0.8.4 | 並行工具 | 高級並行原語 |
| mimalloc | ^0.1.46 | 記憶體分配器 | 高性能記憶體分配 |
| flate2 | ^1.1.1 | 壓縮/解壓 | 數據壓縮處理 |
| regex | ^1.11.1 | 正則表達式 | 文本模式匹配 |
| glob | ^0.3.2 | 文件匹配 | 文件系統模式匹配 |
| num_cpus | ^1.16.0 | CPU信息 | 檢測CPU核心數量 |
| sha2 | ^0.10.9 | 哈希演算法 | 安全哈希 |
| jsonpath_lib | ^0.3.0 | JSON路徑 | JSON數據查詢 |


## 11. 測試工具

| 套件名稱 | 版本 | 用途 | 備註 |
|---------|------|------|------|
| mockall | ^0.13.1 | 模擬庫 | 建立測試模擬 |
| tokio-test | ^0.4.4 | tokio測試工具 | 測試非同步代碼 |
| criterion | ^0.5.1 | 基準測試 | 性能測試 |
| fake | ^4.3.0 | 假數據生成 | 測試數據準備 |
| proptest | ^1.6.0 | 屬性測試 | 生成測試用例 |
| assert_matches | ^1.5.0 | 斷言 | 增強的斷言功能 |
| serial_test | ^3.2.0 | 序列測試 | 控制測試執行順序 |
| tempfile | ^3.19.1 | 臨時文件 | 測試臨時文件操作 |
| test-case | ^3.3.1 | 測試用例 | 易用的測試宏 |